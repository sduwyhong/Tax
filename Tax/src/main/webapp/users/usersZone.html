<!-- 用户专区 -->
<!DOCTYPE html>
<html>
<head>
	<title>安徽省国家税务局税企互助交流平台</title>
	<meta name="viewport" content="width=device-width">
  	<meta http-equiv="content-type" content="text/html; charset=utf-8">
  	<link rel="icon" href="../image/home/favicon.gif" type="image/x-icon">
  	<link rel="stylesheet" type="text/css" href="../css/user/expertPrefecture.css">
  	<link rel="stylesheet" href="../css/paging.css">
  	<link rel="stylesheet" href="../css/zeroModal.css">
	<link rel="stylesheet" type="text/css" href="../PopWin/sweetalert.css"/>
	<script type="text/javascript" src="../PopWin/sweetalert.min.js"></script>
	<style>
		.box{
			width:955px!important;
		}
		#five {
			border-bottom: 1px solid #fff;
		    padding-bottom: 10px;
		    color: #fff;
		    display: inline-block;
		    width: 90%;
		    height: 65%;
		}
		#fiveplus{
			background:#1B55A9;
		}
		body::-webkit-scrollbar {display:none}
		body::-o-scrollbar {display:none}
		body::-ms-scrollbar {display:none}
		body::-moz-scrollbar {display:none}
	</style>
</head>
<body style="min-height:1000px;">
	<!-- header start -->
	<div id="headerpage"></div>
	<!-- header end -->
	<!-- content start -->
	<div class="liuan_content_main">
		<div class="liuan_content">
			<!-- 专家简介 -->
			<div class="tab_main intro">
				<div class="center_main">
					<div class="content_message">
						<div class="user_tou">
							<img src="../image/expert.png">
						</div>
						<div class="all_people">
							<div class="all_people_num">
								<span>总人数：</span><span>-</span>
							</div>
							<div class="all_people_num">
								<span>总答题：</span><span>-</span>
							</div>
							<div class="all_people_num">
								<span>采纳数：</span><span>-</span>
							</div>
							<div class="renzheng">
								<a onclick="userNotNull();"><img src="../image/attestation.png">专家认证</a>
							</div>
						</div>
					</div>
					<div class="expter_massage">
						<h3>专家简介</h3>
						<p>
							专家用户是指具有税务师、注册会计师资格或在税务机关、税务院校从事税收相关工作，
							拥有比较丰富的税收专业知识和办税经验，乐于分享，能够积极主动帮助问税用户答疑解惑的个人。
							专家用户须经本人申请，并经问税平台管理方审核认证。
						</p>
					</div>
				</div>
			</div>
			<!--机构与专家点击切换  -->	
			<div class="expert_org">
				<span class="tab_titles" id="organization">优秀机构</span>
				<span class="header_titles">|</span>
				<span class="tab_titles active" id="expert">优秀专家</span>
				<span class="expert_org_more mores"><a href="orgOrUserRank?type=2">更多</a></span>
				<span class="expert_org_more"><a href="more_pro.html">更多</a></span>
				<div class="gary">
					<div class="darkblue"></div>
				</div>
			</div>
			
		<!--优秀专家机构切换one  -->
		<div class="tab_accordance center">
			<!--优秀专家  -->
			<div class="content_all">
				<div class="center_tabones">
					
						<div class="center_first" hidden="hidden">
							<div class="first_header">
								<a href="users/u0001/zone" style="color:#000;">
									    
									        <img src="" alt="Avatar">
									
								</a>
								<div class="first_content">
									<a href="users/u0001/zone">
										<p>username</p>
									</a>
									<p>
										<span>邮箱：</span><span>-</span>
									</p>
									<p>
										<span>最近访问：</span><span>-</span>
									</p>
								</div>
							</div>
							<div class="conter_center">
								<div class="zongjifen">
									<span>总积分：</span><span>-</span>
								</div>
								<div class="zongjifen">
									<span>回答数：</span><span>-</span>
								</div>
							</div>
							<div class="fasixin">
								<div class="letter">
									<a href="">发私信</a>
								</div>
								<div class="invite">
									<a href="">邀请回答</a>
								</div>
							</div>
						</div>
					
					<!--one end-->
				</div>
			</div>
				
				<!-- 专家 vip -->
				<div class="content_vip">
					<span class="header_titles">实力排行榜</span>
					<div class="gary">
						<div class="pink"></div>
					</div>
					<div class="rankinglist">
						
							<div class="paiming" hidden="hidden">
								<div class="touxiang">
									<a href="users/u0001/zone">
										    
										        <img src="../image/u2815.png" alt="Avatar">
										
									</a>
								</div>
								<div class="paiming_first">
									<a href="users/u0001/zone" style="color:#000!important;">
										用户名：-
									</a>
								</div>
								<div class="zjf">
									<div>
										<span>排名:-</span>
									</div>
									<div>
										<span>总积分:-</span>
									</div>
									<div>
										<span>回答数:-</span>
									</div>
								</div>
							</div>
					</div>
				</div>
			
				<!--专家 答题-->
				<div class="center_last">
					<!-- 分页标题 start -->
					<div class="ex_main_left_content_header">
						<span class="header_titles">答题动态</span>
					</div>
						
					<div id="exSharingContainer">
		    			<div class="exSharingContent answer">
		    				<div class="uesr_message" hidden="hidden">
		    					<div class="message_one">
		    						<a href="/lagsms/questions/ques_1530497262344/details">
		    							<p>title</p>
									</a>
								</div>
								<div class="answer_message">
									<a href="users/user_1530497206836/zone" style="color:#000;">
										<img src="../image/u2815.png" alt="Avatar">
									</a>
									<a href="users/user_1530497206836/zone" style="color:#000;">
										<span>author</span>
									</a>
									<span>2018-07-02</span>
								</div>
							</div>
				<!-- 实现分页 start-->
				<!-- 不满一页：设置pagination的display：none
					  点击数字: 由class=waves-effect变成class=active 
					  首页时:prePage为disabled；尾页时 :nextPage的class为disabled 其他情况时class为waves-effect-->
					<div id="quesPaging" class="box"></div>  						
  				<!-- 实现分页 end-->
					</div>
				</div>
			</div>
		</div>
	
	
	
	<!-- footer start -->
	<div id="footerpage"></div>
	<!-- footer end -->	
	
	<!-- load js -->
	<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
	<script type="text/javascript" src="../js/zeroModel.min.js" charset="utf-8"></script>
	<script type="text/javascript" src="../js/Materialize/materialize.min.js"></script>
	<script type="text/javascript" src="../js/Materialize/adbeus.js"></script>
	<script src="../js/paging.js" type="text/javascript" charset="utf-8"></script>
	<script src="../js/path.js" type="text/javascript" charset="utf-8"></script>
	<!-- load header and footer -->
	<script type="text/javascript">
		$("#headerpage").load("../header.html");
		$("#footerpage").load("../footer.html");
	</script>

	<script type="text/javascript">
		//用户专区
		$.ajax({
			url:path+'guest/userModule',
			success:function(data){
				console.log(data);
				/*
					<div class="all_people">
						<div class="all_people_num">
							<span>总人数：</span><span>-</span>
						</div>
						<div class="all_people_num">
							<span>总答题：</span><span>-</span>
						</div>
						<div class="all_people_num">
							<span>采纳数：</span><span>-</span>
						</div>
						<div class="renzheng">
							<a onclick="userNotNull();"><img src="../image/attestation.png">专家认证</a>
						</div>
					</div>
				*/
				$('.all_people span:odd:eq(0)').text(data.result.userNum);
				$('.all_people span:odd:eq(1)').text(data.result.answerNum);
				$('.all_people span:odd:eq(2)').text(data.result.solvedNum);
				
				var greatCount = 3;
				var rankCount = 4;
				for(var i in data.result.expertRankingList){
					var user = data.result.expertRankingList[i];
					if(greatCount--){
						appendGreatExperts(user);
					}
					if(rankCount--){
						appendRank(user);
					}
				}
			}
		})
		//答题动态
		var totalPage = 0;
		var totalCount = 0;
		$.ajax({
			url:path+'guest/question?page=1',
			async:false,
			success:function(data){
				console.log(data);
				if(data.status == 200){
					totalPage = data.result.totalPage;
					totalCount = data.result.totalCount;
					for(var i in data.result.list){
						var question = data.result.list[i];
						appendQuestion(question);
					}
				}
			}
		})
		initPagination(totalPage,totalCount);
		function initPagination(totalPage,totalCount){
			//分页，只有一页不分页
			$('#quesPaging').paging({
			   initPageNo: 1, 			// 初始页码
		       totalPages: totalPage, 	// 总页数
		       totalCount: '合计 '+totalCount+'条数据', 			// 条目总数
		       slideSpeed: 600, 							// 缓动速度。单位毫秒
		       jump: true, 								// 是否支持跳转
		       initLoad: false,
		       callback: function(page) { 
			       	// 回调函数
			       	$('.uesr_message[hidden!=hidden]').remove();
			       	$.ajax({
			       		url:path+'guest/question?page='+page,
			       		success:function(data){
			       			console.log(data);
			       			if(data.status == 200) {
			       				var list = data.result.list;
			       				for(var i in list){
							       appendQuestion(list[i]);
			       				}
			       			}
			       		}
			       	})
		   		}
			});
		}
		function appendQuestion(question){
			/*
			<div class="uesr_message">
				<div class="message_one">
					<a href="/lagsms/questions/ques_1530497262344/details">
						<p>title</p>
				</a>
				</div>
				<div class="answer_message">
					<a href="users/user_1530497206836/zone" style="color:#000;">
						<img src="../image/u2815.png" alt="Avatar">
					</a>
					<a href="users/user_1530497206836/zone" style="color:#000;">
						<span>author</span>
					</a>
					<span>2018-07-02</span>
				</div>
			</div>
			*/
			var template = $('.uesr_message:first').clone();
			template.removeAttr('hidden');
			template.find('a:eq(0)').attr('href','../consult/ConsultSub.html?id='+question.id);
			template.find('p:eq(0)').text(question.title);
			template.find('a:eq(1)').attr('href','per_data.html?id='+question.authorId);
			template.find('a:eq(2)').attr('href','per_data.html?id='+question.authorId);
			template.find('img').attr('src',path+'guest/avatar/'+question.authorId)
			template.find('span:eq(0)').text(question.authorName);
			template.find('span:eq(1)').text(getDate(question.publishDate));
			$('.uesr_message:last').after(template);
		}
		function appendGreatExperts(user){
			/*
			<div class="center_first">
				<div class="first_header">
					<a href="users/u0001/zone" style="color:#000;">
				        <img src="../image/u2815.png" alt="Avatar">
					</a>
					<div class="first_content">
						<a href="users/u0001/zone">
							<p>username</p>
						</a>
						<p>
							<span>邮箱：</span><span>-</span>
						</p>
						<p>
							<span>最近访问：</span><span>-</span>
						</p>
					</div>
				</div>
				<div class="conter_center">
					<div class="zongjifen">
						<span>总积分：</span><span>-</span>
					</div>
					<div class="zongjifen">
						<span>回答数：</span><span>-</span>
					</div>
				</div>
				<div class="fasixin">
					<div class="letter">
						<a href="">发私信</a>
					</div>
					<div class="invite">
						<a href="">邀请回答</a>
					</div>
				</div>
			</div>
			*/
			var template = $('.center_first:first').clone();
			template.removeAttr('hidden');
			template.find('a:eq(0)').attr('href','per_data.html?id='+user.id);
			template.find('img').attr('src', path+'guest/avatar/'+user.id);
			template.find('p:first').text(user.username);
			template.find('span:odd:eq(0)').text(user.email);
			template.find('span:odd:eq(1)').text(getDate(user.last_visit));
			template.find('span:odd:eq(2)').text(user.scores);
			template.find('span:odd:eq(3)').text(user.answerNum);
			//登录验证
			console.log("auth:"+auth);
			template.find('a:eq(2)').attr('href','javascript:turnToMessagePage(\''+user.id+'\')');
			template.find('a:eq(3)').attr('href','javascript:turnToInvitationPage(\''+user.id+'\')');
			$('.center_first:last').after(template);
		}
		function turnToMessagePage(id){
			if(!auth) alert('请先登录！');
			else location.href = 'message.html?id='+id;
		}
		function turnToInvitationPage(id){
			if(!auth) alert('请先登录！');
			else location.href = 'invitation.html?id='+id;
		}
		function appendRank(user){
			/*
			<div class="paiming">
				<div class="touxiang">
					<a href="users/u0001/zone">
				        <img src="../image/u2815.png" alt="Avatar">
					</a>
				</div>
				<div class="paiming_first">
					<a href="users/u0001/zone" style="color:#000!important;">
						用户名：-
					</a>
				</div>
				<div class="zjf">
					<div>
						<span>排名:-</span>
					</div>
					<div>
						<span>总积分:-</span>
					</div>
					<div>
						<span>回答数:-</span>
					</div>
				</div>
			</div>
			*/
			var template = $('.paiming:first').clone();
			template.removeAttr('hidden');
			template.find('img').attr('src',path+'guest/avatar/'+user.id);
			template.find('a:eq(0)').attr('href','per_data.html?id='+user.id);
			template.find('a:eq(1)').text('用户名：'+user.username);
			template.find('span:eq(0)').text('排名：'+user.rank);
			template.find('span:eq(1)').text('总积分：'+user.scores);
			template.find('span:eq(2)').text('回答数：'+user.answerNum);
			$('.paiming:last').after(template);
		}
		//转换时间戳
		function getDate(value){
			 return new Date(parseInt(("/Date("+value+")/").substr(6, 13))).toLocaleDateString();  
		}
	</script>

</body>
</html>